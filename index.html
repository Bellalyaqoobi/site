<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اسنپ افغانستان - سیستم کامل مدیریت تاکسی اینترنتی</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- صفحه خوشآمدگویی -->
    <div class="welcome-page" id="welcome-page">
        <div class="welcome-content">
            <div class="welcome-logo">
                <i class="fas fa-car-side"></i>
                <span>اسنپ افغانستان</span>
            </div>
            <h1 class="welcome-title">سرویس تاکسی اینترنتی در سراسر کابل</h1>
            <p class="welcome-subtitle">سریع، مطمئن و مقرون به صرفه</p>
            
            <div class="welcome-features">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-bolt"></i>
                    </div>
                    <h3 class="feature-title">سریع و آسان</h3>
                    <p class="feature-desc">در کمتر از ۵ دقیقه یک خودرو در نزدیکی شما خواهد بود</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3 class="feature-title">مطمئن و امن</h3>
                    <p class="feature-desc">تمام رانندگان ما تایید شده و دارای بیمه هستند</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-money-bill-wave"></i>
                    </div>
                    <h3 class="feature-title">قیمت مناسب</h3>
                    <p class="feature-desc">قیمتهای شفاف و رقابتی با امکان پرداخت نقدی</p>
                </div>
            </div>
            
            <div class="welcome-actions">
                <button class="btn-welcome btn-welcome-primary" id="start-using-btn">
                    <i class="fas fa-play-circle"></i>
                    شروع استفاده از اسنپ
                </button>
                <button class="btn-welcome btn-welcome-outline" id="learn-more-btn">
                    <i class="fas fa-info-circle"></i>
                    اطلاعات بیشتر
                </button>
            </div>
        </div>
    </div>

    <!-- هدر اصلی -->
    <header style="display: none;" id="main-header">
        <div class="container nav-container">
            <a href="#" class="logo" data-page="home">
                <i class="fas fa-car-side"></i>
                <span>اسنپ افغانستان</span>
            </a>
            <ul class="nav-links">
                <li><a href="#" class="nav-link active" data-page="home"><i class="fas fa-home"></i> خانه</a></li>
                <li><a href="#" class="nav-link" data-page="my-trips"><i class="fas fa-history"></i> سفرهای من</a></li>
                <li><a href="#" class="nav-link" data-page="discounts"><i class="fas fa-gift"></i> تخفیفها</a></li>
                <li><a href="#" class="nav-link" data-page="support"><i class="fas fa-question-circle"></i> پشتیبانی</a></li>
                <li><a href="#" class="nav-link" data-page="profile"><i class="fas fa-user"></i> پروفایل</a></li>
                <li><a href="#" class="nav-link" data-page="admin" id="adminLink" style="display: none;"><i class="fas fa-cog"></i> پنل مدیریت</a></li>
            </ul>
            <div class="user-actions">
                <div class="user-profile" id="userProfile" style="display: none;">
                    <div class="user-avatar" id="userAvatar">ا</div>
                    <div class="user-name" id="userName">احمد محمدی</div>
                </div>
                <button class="btn btn-outline" id="loginBtn"><i class="fas fa-user"></i> ورود / ثبتنام</button>
                <button class="btn btn-outline" id="logoutBtn" style="display: none;"><i class="fas fa-sign-out-alt"></i> خروج</button>
            </div>
            <div class="hamburger" id="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </header>

    <!-- منوی موبایل -->
    <div class="mobile-menu" id="mobileMenu">
        <div class="mobile-menu-header">
            <div class="mobile-menu-logo">
                <i class="fas fa-car-side"></i>
                <span>اسنپ افغانستان</span>
            </div>
            <button class="close-menu" id="closeMenu">&times;</button>
        </div>
        <ul class="mobile-nav-links">
            <li><a href="#" class="nav-link active" data-page="home"><i class="fas fa-home"></i> خانه</a></li>
            <li><a href="#" class="nav-link" data-page="my-trips"><i class="fas fa-history"></i> سفرهای من</a></li>
            <li><a href="#" class="nav-link" data-page="discounts"><i class="fas fa-gift"></i> تخفیفها</a></li>
            <li><a href="#" class="nav-link" data-page="support"><i class="fas fa-question-circle"></i> پشتیبانی</a></li>
            <li><a href="#" class="nav-link" data-page="profile"><i class="fas fa-user"></i> پروفایل</a></li>
            <li><a href="#" class="nav-link" data-page="admin" id="mobileAdminLink" style="display: none;"><i class="fas fa-cog"></i> پنل مدیریت</a></li>
        </ul>
        <div class="mobile-user-actions">
            <button class="btn btn-primary" id="mobileLoginBtn" style="width: 100%;">ورود / ثبتنام</button>
            <button class="btn btn-outline" id="mobileLogoutBtn" style="width: 100%; display: none;">خروج</button>
        </div>
    </div>
    <div class="overlay" id="overlay"></div>

    <!-- محتوای اصلی -->
    <div class="container" style="display: none;" id="main-container">
        <!-- صفحه خانه -->
        <div class="page active" id="home-page">
            <div class="main-content">
                <!-- نقشه -->
                <div class="map-container">
                    <div id="map"></div>
                    
                    <!-- ردیابی زنده -->
                    <div class="live-tracking" id="liveTracking" style="display: none;">
                        <div class="tracking-header">
                            <h3><i class="fas fa-map-marker-alt"></i> ردیابی زنده</h3>
                            <button class="close-modal" id="closeTracking">&times;</button>
                        </div>
                        <div class="tracking-info">
                            <div class="tracking-row">
                                <span class="tracking-label">راننده:</span>
                                <span class="tracking-value" id="trackingDriverName">احمد ظاهر</span>
                            </div>
                            <div class="tracking-row">
                                <span class="tracking-label">زمان رسیدن:</span>
                                <span class="tracking-value" id="trackingETA">۴ دقیقه</span>
                            </div>
                            <div class="tracking-row">
                                <span class="tracking-label">مسافت باقیمانده:</span>
                                <span class="tracking-value" id="trackingDistance">۲.۸ کیلومتر</span>
                            </div>
                            <div class="progress-container">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="trackingProgress"></div>
                                </div>
                                <div class="progress-text">
                                    <span>مبدا</span>
                                    <span>مقصد</span>
                                </div>
                            </div>
                            <button class="btn btn-outline" id="cancelTracking" style="width: 100%; margin-top: 10px;">
                                <i class="fas fa-times"></i>
                                لغو سفر
                            </button>
                        </div>
                    </div>
                    
                    <!-- وضعیت جستجو -->
                    <div class="searching-overlay" id="searchingOverlay">
                        <div class="searching-animation"></div>
                        <div class="searching-text" id="searchingText">در حال یافتن نزدیکترین راننده...</div>
                        <button class="cancel-search" id="cancelSearch">لغو درخواست</button>
                    </div>
                </div>

                <!-- پنل درخواست سفر -->
                <div class="ride-panel">
                    <h2 class="panel-title"><i class="fas fa-map-marker-alt"></i> درخواست سفر</h2>
                    
                    <form class="ride-form" id="rideForm">
                        <div class="form-group">
                            <label for="pickup"><i class="fas fa-circle"></i> مبدا</label>
                            <div class="input-with-icon">
                                <i class="fas fa-map-marker-alt input-icon"></i>
                                <input type="text" id="pickup" class="form-input" placeholder="آدرس فعلی شما" required>
                            </div>
                        </div>
                        
                        <div class="location-swap">
                            <button type="button" class="swap-btn" id="swapLocations">
                                <i class="fas fa-exchange-alt"></i>
                            </button>
                        </div>
                        
                        <div class="form-group">
                            <label for="destination"><i class="fas fa-flag-checkered"></i> مقصد</label>
                            <div class="input-with-icon">
                                <i class="fas fa-flag-checkered input-icon"></i>
                                <input type="text" id="destination" class="form-input" placeholder="محل مورد نظر شما" required>
                            </div>
                        </div>

                        <!-- محاسبه قیمت -->
                        <div class="trip-calculator" id="tripCalculator" style="display: none;">
                            <div class="calculator-row">
                                <span>مسافت تخمینی:</span>
                                <span id="distanceValue">0 کیلومتر</span>
                            </div>
                            <div class="calculator-row">
                                <span>کرایه پایه:</span>
                                <span id="baseFareValue">0 افغانی</span>
                            </div>
                            <div class="calculator-row">
                                <span>کرایه مسافت:</span>
                                <span id="distanceFareValue">0 افغانی</span>
                            </div>
                            <div class="calculator-row">
                                <span>هزینه نهایی:</span>
                                <span id="totalFareValue">0 افغانی</span>
                            </div>
                        </div>

                        <div class="form-group">
                            <label><i class="fas fa-car"></i> نوع سفر</label>
                            <div class="ride-type-selector" id="rideTypeSelector">
                                <div class="ride-type economy selected" data-type="economy" data-base-fare="50">
                                    <div class="ride-type-info">
                                        <div class="ride-icon">
                                            <i class="fas fa-car"></i>
                                        </div>
                                        <div class="ride-details">
                                            <h3>اقتصادی</h3>
                                            <p>مناسب برای سفرهای روزمره</p>
                                        </div>
                                    </div>
                                    <div class="ride-price">
                                        <div id="economyPrice">-- افغانی</div>
                                        <div class="price-estimate">برآورد قیمت</div>
                                    </div>
                                </div>
                                <div class="ride-type comfort" data-type="comfort" data-base-fare="80">
                                    <div class="ride-type-info">
                                        <div class="ride-icon">
                                            <i class="fas fa-car-side"></i>
                                        </div>
                                        <div class="ride-details">
                                            <h3>کلاسیک</h3>
                                            <p>خودروی مناسب و راحت</p>
                                        </div>
                                    </div>
                                    <div class="ride-price">
                                        <div id="comfortPrice">-- افغانی</div>
                                        <div class="price-estimate">برآورد قیمت</div>
                                    </div>
                                </div>
                                <div class="ride-type bike" data-type="bike" data-base-fare="30">
                                    <div class="ride-type-info">
                                        <div class="ride-icon">
                                            <i class="fas fa-motorcycle"></i>
                                        </div>
                                        <div class="ride-details">
                                            <h3>موتور</h3>
                                            <p>سریع و مقرون به صرفه</p>
                                        </div>
                                    </div>
                                    <div class="ride-price">
                                        <div id="bikePrice">-- افغانی</div>
                                        <div class="price-estimate">برآورد قیمت</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- روش پرداخت -->
                        <div class="form-group">
                            <label><i class="fas fa-credit-card"></i> روش پرداخت</label>
                            <div class="payment-methods">
                                <div class="payment-method selected" data-method="cash">
                                    <i class="fas fa-money-bill-wave"></i>
                                    <span>نقدی</span>
                                </div>
                                <div class="payment-method" data-method="wallet">
                                    <i class="fas fa-wallet"></i>
                                    <span>کیف پول</span>
                                </div>
                            </div>
                        </div>

                        <button type="submit" class="submit-btn" id="submitBtn">
                            <i class="fas fa-search"></i>
                            درخواست خودرو
                        </button>
                    </form>

                    <!-- مناطق کابل -->
                    <div class="kabul-districts">
                        <h3 class="districts-title"><i class="fas fa-map"></i> مناطق کابل</h3>
                        <div class="districts-grid" id="districtsGrid">
                            <!-- مناطق به صورت داینامیک اضافه میشوند -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- پیشنهادات مقصد -->
            <div class="suggestions">
                <h3 class="suggestions-title"><i class="fas fa-fire"></i> مقاصد پرطرفدار در کابل</h3>
                <div class="suggestion-list" id="suggestionsList">
                    <!-- مقاصد به صورت داینامیک اضافه میشوند -->
                </div>
            </div>

            <!-- بنر تبلیغاتی -->
            <div class="promo-banner">
                <div class="promo-title">اولین سفر رایگان!</div>
                <div class="promo-desc">با کد WELCOME100 از ۱۰۰ افغانی تخفیف در اولین سفر خود استفاده کنید</div>
            </div>
        </div>

        <!-- صفحه سفرهای من -->
        <div class="page" id="my-trips-page">
            <h2 class="page-title"><i class="fas fa-history"></i> سفرهای من</h2>
            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>تاریخ</th>
                            <th>مبدا</th>
                            <th>مقصد</th>
                            <th>نوع سفر</th>
                            <th>مسافت</th>
                            <th>هزینه</th>
                            <th>وضعیت</th>
                            <th>عملیات</th>
                        </tr>
                    </thead>
                    <tbody id="myTripsTable">
                        <!-- سفرهای کاربر به صورت داینامیک اضافه میشوند -->
                        <tr>
                            <td colspan="8" style="text-align: center; padding: 30px; color: var(--gray);">
                                در حال بارگذاری سفرها...
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- صفحه تخفیفها -->
        <div class="page" id="discounts-page">
            <h2 class="page-title"><i class="fas fa-gift"></i> تخفیفها</h2>
            <div id="discountsList">
                <!-- تخفیفها به صورت داینامیک اضافه میشوند -->
                <div style="text-align: center; padding: 50px; color: var(--gray);">
                    <i class="fas fa-gift" style="font-size: 48px; margin-bottom: 20px;"></i>
                    <p>در حال بارگذاری تخفیف‌ها...</p>
                </div>
            </div>
        </div>

        <!-- صفحه پشتیبانی -->
        <div class="page" id="support-page">
            <h2 class="page-title"><i class="fas fa-question-circle"></i> پشتیبانی</h2>
            
            <div class="chat-container">
                <div class="chat-messages" id="chatMessages">
                    <div class="message received">
                        سلام! به پشتیبانی اسنپ افغانستان خوش آمدید. چگونه میتوانم کمکتان کنم؟
                        <div class="message-time">امروز ۱۲:۳۰</div>
                    </div>
                </div>
                <div class="chat-input">
                    <input type="text" id="chatInput" placeholder="پیام خود را بنویسید...">
                    <button id="sendMessage"><i class="fas fa-paper-plane"></i></button>
                </div>
            </div>
            
            <div class="support-info" style="margin-top: 30px;">
                <h3>راههای ارتباطی</h3>
                <p><i class="fas fa-phone"></i> شماره تماس: ۰۷۰۰۱۲۳۴۵۶</p>
                <p><i class="fas fa-envelope"></i> ایمیل: support@snapp.af</p>
                <p><i class="fas fa-clock"></i> ساعات پاسخگویی: ۲۴ ساعته</p>
            </div>
        </div>

        <!-- صفحه پروفایل -->
        <div class="page" id="profile-page">
            <h2 class="page-title"><i class="fas fa-user"></i> پروفایل</h2>
            
            <div class="profile-section">
                <div class="profile-header">
                    <div class="profile-avatar" id="profileAvatar">ا</div>
                    <div class="profile-info">
                        <h3 id="profileName">احمد محمدی</h3>
                        <p><i class="fas fa-envelope"></i> <span id="profileEmail">ahmad@example.com</span></p>
                        <p><i class="fas fa-phone"></i> <span id="profilePhone">۰۷۰۰۱۱۱۲۲۲</span></p>
                        <p><i class="fas fa-user-tag"></i> <span id="profileRole">مسافر</span></p>
                    </div>
                </div>
                
                <div class="profile-stats">
                    <div class="profile-stat">
                        <div class="value" id="totalTripsCount">۰</div>
                        <div class="label">تعداد سفرها</div>
                    </div>
                    <div class="profile-stat">
                        <div class="value" id="totalSpent">۰</div>
                        <div class="label">افغانی هزینه شده</div>
                    </div>
                    <div class="profile-stat">
                        <div class="value" id="userRating">۵.۰</div>
                        <div class="label">امتیاز شما</div>
                    </div>
                </div>
                
                <h3 style="margin: 30px 0 20px 0; color: var(--dark);">ویرایش پروفایل</h3>
                
                <div class="form-group">
                    <label for="editName"><i class="fas fa-user"></i> نام کامل</label>
                    <input type="text" id="editName" class="form-input" placeholder="نام کامل خود را وارد کنید">
                </div>
                
                <div class="form-group">
                    <label for="editEmail"><i class="fas fa-envelope"></i> ایمیل</label>
                    <input type="email" id="editEmail" class="form-input" placeholder="ایمیل خود را وارد کنید">
                </div>
                
                <div class="form-group">
                    <label for="editPhone"><i class="fas fa-phone"></i> شماره تماس</label>
                    <input type="tel" id="editPhone" class="form-input" placeholder="شماره تماس خود را وارد کنید">
                </div>
                
                <button class="btn btn-primary" id="saveProfile">
                    <i class="fas fa-save"></i>
                    ذخیره تغییرات
                </button>
                
                <!-- تغییر رمز عبور -->
                <h3 style="margin: 40px 0 20px 0; color: var(--dark);">تغییر رمز عبور</h3>
                
                <div class="form-group">
                    <label for="currentPassword"><i class="fas fa-lock"></i> رمز عبور فعلی</label>
                    <div class="input-with-icon">
                        <i class="fas fa-lock input-icon"></i>
                        <input type="password" id="currentPassword" class="form-input" placeholder="رمز عبور فعلی">
                        <button type="button" class="password-toggle" id="currentPasswordToggle">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="newPassword"><i class="fas fa-lock"></i> رمز عبور جدید</label>
                    <div class="input-with-icon">
                        <i class="fas fa-lock input-icon"></i>
                        <input type="password" id="newPassword" class="form-input" placeholder="رمز عبور جدید">
                        <button type="button" class="password-toggle" id="newPasswordToggle">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="confirmNewPassword"><i class="fas fa-lock"></i> تکرار رمز عبور جدید</label>
                    <div class="input-with-icon">
                        <i class="fas fa-lock input-icon"></i>
                        <input type="password" id="confirmNewPassword" class="form-input" placeholder="تکرار رمز عبور جدید">
                        <button type="button" class="password-toggle" id="confirmNewPasswordToggle">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                
                <button class="btn btn-outline" id="changePassword">
                    <i class="fas fa-key"></i>
                    تغییر رمز عبور
                </button>
            </div>
        </div>

        <!-- صفحه پنل مدیریت -->
        <div class="page admin-panel" id="admin-page">
            <h2 class="page-title"><i class="fas fa-cog"></i> پنل مدیریت</h2>
            
            <div class="admin-stats">
                <div class="stat-card">
                    <h3>تعداد سفرها</h3>
                    <div class="value" id="totalTrips">0</div>
                    <div class="change positive"><i class="fas fa-arrow-up"></i> ۱۲% نسبت به ماه گذشته</div>
                </div>
                <div class="stat-card">
                    <h3>کاربران فعال</h3>
                    <div class="value" id="activeUsers">0</div>
                    <div class="change positive"><i class="fas fa-arrow-up"></i> ۸% نسبت به ماه گذشته</div>
                </div>
                <div class="stat-card">
                    <h3>رانندگان</h3>
                    <div class="value" id="totalDrivers">0</div>
                    <div class="change positive"><i class="fas fa-arrow-up"></i> ۵% نسبت به ماه گذشته</div>
                </div>
                <div class="stat-card">
                    <h3>درآمد کل</h3>
                    <div class="value" id="totalRevenue">0 افغانی</div>
                    <div class="change positive"><i class="fas fa-arrow-up"></i> ۱۵% نسبت به ماه گذشته</div>
                </div>
            </div>
            
            <div class="admin-tabs">
                <div class="admin-tab active" data-tab="users">
                    <i class="fas fa-users"></i>
                    مدیریت کاربران
                </div>
                <div class="admin-tab" data-tab="drivers">
                    <i class="fas fa-car"></i>
                    مدیریت رانندگان
                </div>
                <div class="admin-tab" data-tab="trips">
                    <i class="fas fa-road"></i>
                    مدیریت سفرها
                </div>
                <div class="admin-tab" data-tab="discounts">
                    <i class="fas fa-tag"></i>
                    مدیریت تخفیفها
                </div>
                <div class="admin-tab" data-tab="support">
                    <i class="fas fa-headset"></i>
                    مدیریت پشتیبانی
                </div>
            </div>
            
            <!-- مدیریت کاربران -->
            <div class="admin-tab-content active" id="users-tab">
                <div class="admin-section-header">
                    <h3>کاربران در انتظار تایید</h3>
                    <button class="btn btn-primary" id="refreshUsersBtn">
                        <i class="fas fa-sync-alt"></i>
                        بروزرسانی
                    </button>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>نام</th>
                                <th>ایمیل</th>
                                <th>شماره تماس</th>
                                <th>نوع کاربر</th>
                                <th>تاریخ ثبتنام</th>
                                <th>عملیات</th>
                            </tr>
                        </thead>
                        <tbody id="pendingUsersTable">
                            <tr>
                                <td colspan="6" style="text-align: center; padding: 30px; color: var(--gray);">
                                    در حال بارگذاری کاربران...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="admin-section-header" style="margin-top: 40px;">
                    <h3>همه کاربران</h3>
                    <div class="action-buttons">
                        <button class="btn btn-primary" id="exportUsersBtn">
                            <i class="fas fa-download"></i>
                            خروجی Excel
                        </button>
                        <button class="btn btn-edit" id="filterUsersBtn">
                            <i class="fas fa-filter"></i>
                            فیلتر
                        </button>
                    </div>
                </div>
                <div class="filters" id="usersFilters" style="display: none;">
                    <div class="filter-group">
                        <label>نوع کاربر</label>
                        <select id="filterUserType">
                            <option value="">همه</option>
                            <option value="passenger">مسافر</option>
                            <option value="driver">راننده</option>
                            <option value="admin">مدیر</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>وضعیت</label>
                        <select id="filterUserStatus">
                            <option value="">همه</option>
                            <option value="pending">در انتظار تایید</option>
                            <option value="approved">تایید شده</option>
                            <option value="rejected">رد شده</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>از تاریخ</label>
                        <input type="date" id="filterUserDateFrom">
                    </div>
                    <div class="filter-group">
                        <label>تا تاریخ</label>
                        <input type="date" id="filterUserDateTo">
                    </div>
                    <button class="btn btn-primary" id="applyUserFilter">اعمال فیلتر</button>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>نام</th>
                                <th>ایمیل</th>
                                <th>شماره تماس</th>
                                <th>نوع کاربر</th>
                                <th>وضعیت</th>
                                <th>تاریخ ثبتنام</th>
                                <th>عملیات</th>
                            </tr>
                        </thead>
                        <tbody id="allUsersTable">
                            <tr>
                                <td colspan="7" style="text-align: center; padding: 30px; color: var(--gray);">
                                    در حال بارگذاری کاربران...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- مدیریت رانندگان -->
            <div class="admin-tab-content" id="drivers-tab">
                <div class="admin-section-header">
                    <h3>مدیریت رانندگان</h3>
                    <div class="action-buttons">
                        <button class="btn btn-primary" id="addDriverBtn">
                            <i class="fas fa-plus"></i>
                            افزودن راننده جدید
                        </button>
                        <button class="btn btn-edit" id="refreshDriversBtn">
                            <i class="fas fa-sync-alt"></i>
                            بروزرسانی
                        </button>
                        <button class="btn btn-secondary" id="exportDriversBtn">
                            <i class="fas fa-download"></i>
                            خروجی Excel
                        </button>
                    </div>
                </div>
                <div class="filters" id="driversFilters" style="display: none;">
                    <div class="filter-group">
                        <label>وضعیت</label>
                        <select id="filterDriverStatus">
                            <option value="">همه</option>
                            <option value="available">آماده به کار</option>
                            <option value="busy">مشغول</option>
                            <option value="offline">آفلاین</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>نوع وسیله</label>
                        <select id="filterVehicleType">
                            <option value="">همه</option>
                            <option value="car">خودرو</option>
                            <option value="bike">موتور</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>حداقل امتیاز</label>
                        <select id="filterMinRating">
                            <option value="0">همه</option>
                            <option value="4">۴ به بالا</option>
                            <option value="4.5">۴.۵ به بالا</option>
                            <option value="5">۵</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" id="applyDriverFilter">اعمال فیلتر</button>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>نام</th>
                                <th>شماره تماس</th>
                                <th>نوع وسیله</th>
                                <th>مدل خودرو</th>
                                <th>پلاک</th>
                                <th>وضعیت</th>
                                <th>عملیات</th>
                            </tr>
                        </thead>
                        <tbody id="driversTable">
                            <tr>
                                <td colspan="7" style="text-align: center; padding: 30px; color: var(--gray);">
                                    در حال بارگذاری رانندگان...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- مدیریت سفرها -->
            <div class="admin-tab-content" id="trips-tab">
                <div class="admin-section-header">
                    <h3>مدیریت سفرها</h3>
                    <div class="action-buttons">
                        <button class="btn btn-secondary" id="exportTripsBtn" style="margin-left: 10px;">
                            <i class="fas fa-download"></i>
                            گزارش سفرها
                        </button>
                        <button class="btn btn-secondary" id="exportRevenueBtn">
                            <i class="fas fa-chart-line"></i>
                            گزارش مالی
                        </button>
                    </div>
                </div>
                <div class="filters" id="tripsFilters" style="display: none;">
                    <div class="filter-group">
                        <label>وضعیت</label>
                        <select id="filterTripStatus">
                            <option value="">همه</option>
                            <option value="requested">درخواست شده</option>
                            <option value="confirmed">تأیید شده</option>
                            <option value="in_progress">در حال سفر</option>
                            <option value="completed">تکمیل شده</option>
                            <option value="cancelled">لغو شده</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>نوع سفر</label>
                        <select id="filterTripType">
                            <option value="">همه</option>
                            <option value="economy">اقتصادی</option>
                            <option value="comfort">کلاسیک</option>
                            <option value="bike">موتور</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>از تاریخ</label>
                        <input type="date" id="filterTripDateFrom">
                    </div>
                    <div class="filter-group">
                        <label>تا تاریخ</label>
                        <input type="date" id="filterTripDateTo">
                    </div>
                    <button class="btn btn-primary" id="applyTripFilter">اعمال فیلتر</button>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>تاریخ</th>
                                <th>مسافر</th>
                                <th>راننده</th>
                                <th>مبدا</th>
                                <th>مقصد</th>
                                <th>هزینه</th>
                                <th>وضعیت</th>
                                <th>عملیات</th>
                            </tr>
                        </thead>
                        <tbody id="adminTripsTable">
                            <tr>
                                <td colspan="8" style="text-align: center; padding: 30px; color: var(--gray);">
                                    در حال بارگذاری سفرها...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- مدیریت تخفیفها -->
            <div class="admin-tab-content" id="discounts-tab">
                <div class="admin-section-header">
                    <h3>تخفیف‌ها</h3>
                    <button class="btn btn-primary" id="addDiscountBtn">
                        <i class="fas fa-plus"></i>
                        افزودن تخفیف جدید
                    </button>
                </div>
                <div class="filters" id="discountsFilters" style="display: none;">
                    <div class="filter-group">
                        <label>وضعیت</label>
                        <select id="filterDiscountStatus">
                            <option value="">همه</option>
                            <option value="active">فعال</option>
                            <option value="expired">منقضی شده</option>
                            <option value="exhausted">تمام شده</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>از تاریخ انقضا</label>
                        <input type="date" id="filterDiscountDateFrom">
                    </div>
                    <div class="filter-group">
                        <label>تا تاریخ انقضا</label>
                        <input type="date" id="filterDiscountDateTo">
                    </div>
                    <button class="btn btn-primary" id="applyDiscountFilter">اعمال فیلتر</button>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>کد تخفیف</th>
                                <th>درصد تخفیف</th>
                                <th>تاریخ انقضا</th>
                                <th>کاربران استفاده‌کننده</th>
                                <th>وضعیت</th>
                                <th>عملیات</th>
                            </tr>
                        </thead>
                        <tbody id="discountsTable">
                            <tr>
                                <td colspan="6" style="text-align: center; padding: 30px; color: var(--gray);">
                                    در حال بارگذاری تخفیف‌ها...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- مدیریت پشتیبانی -->
            <div class="admin-tab-content" id="support-tab">
                <div class="admin-section-header">
                    <h3>تیکت‌های پشتیبانی</h3>
                    <div class="action-buttons">
                        <button class="btn btn-secondary" id="notifyAllBtn" style="margin-left: 10px;">
                            <i class="fas fa-bell"></i>
                            ارسال اعلان عمومی
                        </button>
                        <button class="btn btn-primary" id="notifyUsersBtn">
                            <i class="fas fa-envelope"></i>
                            ارسال پیام به کاربران
                        </button>
                    </div>
                </div>
                <div class="filters" id="supportFilters" style="display: none;">
                    <div class="filter-group">
                        <label>وضعیت</label>
                        <select id="filterSupportStatus">
                            <option value="">همه</option>
                            <option value="pending">در انتظار پاسخ</option>
                            <option value="answered">پاسخ داده شده</option>
                            <option value="closed">بسته شده</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>از تاریخ</label>
                        <input type="date" id="filterSupportDateFrom">
                    </div>
                    <div class="filter-group">
                        <label>تا تاریخ</label>
                        <input type="date" id="filterSupportDateTo">
                    </div>
                    <button class="btn btn-primary" id="applySupportFilter">اعمال فیلتر</button>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>کاربر</th>
                                <th>موضوع</th>
                                <th>پیام</th>
                                <th>تاریخ</th>
                                <th>وضعیت</th>
                                <th>عملیات</th>
                            </tr>
                        </thead>
                        <tbody id="adminSupportTable">
                            <tr>
                                <td colspan="6" style="text-align: center; padding: 30px; color: var(--gray);">
                                    در حال بارگذاری درخواست‌ها...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- مدال راننده -->
    <div class="modal" id="driverModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title"><i class="fas fa-check-circle"></i> راننده پیدا شد!</h2>
                <button class="close-modal" id="closeModal">&times;</button>
            </div>
            
            <div class="driver-info">
                <div class="driver-details">
                    <div class="driver-avatar" id="driverAvatar">ا</div>
                    <div class="driver-name-rating">
                        <h3 id="driverName">احمد ظاهر</h3>
                        <div class="driver-rating">
                            <span class="stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star-half-alt"></i>
                            </span>
                            <span id="driverRating">۴.۷</span>
                            <span id="driverTrips">(۱۲۵ سفر)</span>
                        </div>
                    </div>
                </div>
                
                <div class="car-details">
                    <div class="car-info">
                        <div class="car-model" id="carModel">تویوتا کورولا</div>
                        <div class="car-color" id="carColor">سفید</div>
                    </div>
                    <div class="car-plate" id="plateNumber">کابل ۱۲۳۴</div>
                </div>
            </div>
            
            <div class="trip-info">
                <div class="trip-detail">
                    <i class="fas fa-clock"></i>
                    <span>زمان رسیدن</span>
                    <div class="value" id="eta">۴ دقیقه</div>
                </div>
                <div class="trip-detail">
                    <i class="fas fa-road"></i>
                    <span>مسافت</span>
                    <div class="value" id="distance">۲.۸ کیلومتر</div>
                </div>
                <div class="trip-detail">
                    <i class="fas fa-money-bill-wave"></i>
                    <span>هزینه</span>
                    <div class="value" id="price">۱۵۰ افغانی</div>
                </div>
            </div>
            
            <div class="modal-actions">
                <button class="btn btn-outline" id="cancelRide">
                    <i class="fas fa-times"></i>
                    لغو سفر
                </button>
                <button class="btn btn-primary" id="confirmRide">
                    <i class="fas fa-check"></i>
                    تأیید سفر
                </button>
            </div>
        </div>
    </div>

    <!-- مدال امتیازدهی -->
    <div class="modal" id="ratingModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title"><i class="fas fa-star"></i> امتیازدهی به راننده</h2>
                <button class="close-modal" id="closeRatingModal">&times;</button>
            </div>
            
            <div style="text-align: center; padding: 20px 0;">
                <div class="driver-details" style="justify-content: center; margin-bottom: 25px;">
                    <div class="driver-avatar" id="ratingDriverAvatar">ا</div>
                    <div class="driver-name-rating">
                        <h3 id="ratingDriverName">احمد ظاهر</h3>
                    </div>
                </div>
                
                <p style="margin-bottom: 20px; font-size: 16px; color: var(--gray);">لطفاً به راننده امتیاز دهید</p>
                
                <div class="rating-stars" id="ratingStars">
                    <i class="fas fa-star rating-star" data-rating="1"></i>
                    <i class="fas fa-star rating-star" data-rating="2"></i>
                    <i class="fas fa-star rating-star" data-rating="3"></i>
                    <i class="fas fa-star rating-star" data-rating="4"></i>
                    <i class="fas fa-star rating-star" data-rating="5"></i>
                </div>
                
                <textarea id="ratingComment" placeholder="نظر خود را بنویسید (اختیاری)" style="width: 100%; padding: 15px; border: 1px solid var(--border); border-radius: 12px; margin-top: 20px; resize: vertical; min-height: 100px; font-family: inherit; font-size: 14px;"></textarea>
            </div>
            
            <div class="modal-actions">
                <button class="btn btn-primary" id="submitRating">
                    <i class="fas fa-paper-plane"></i>
                    ثبت امتیاز
                </button>
            </div>
        </div>
    </div>

    <!-- مدال پرداخت -->
    <div class="modal" id="paymentModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title"><i class="fas fa-credit-card"></i> پرداخت</h2>
                <button class="close-modal" id="closePaymentModal">&times;</button>
            </div>
            
            <div style="padding: 20px 0;">
                <div class="trip-info">
                    <div class="trip-detail">
                        <i class="fas fa-road"></i>
                        <span>مسافت</span>
                        <div class="value" id="paymentDistance">۲.۸ کیلومتر</div>
                    </div>
                    <div class="trip-detail">
                        <i class="fas fa-money-bill-wave"></i>
                        <span>هزینه</span>
                        <div class="value" id="paymentPrice">۱۵۰ افغانی</div>
                    </div>
                </div>
                
                <div class="form-group" style="margin-top: 25px;">
                    <label><i class="fas fa-credit-card"></i> روش پرداخت</label>
                    <div class="payment-methods">
                        <div class="payment-method selected" data-method="cash">
                            <i class="fas fa-money-bill-wave"></i>
                            <span>نقدی</span>
                        </div>
                        <div class="payment-method" data-method="wallet">
                            <i class="fas fa-wallet"></i>
                            <span>کیف پول</span>
                        </div>
                    </div>
                </div>
                
                <div id="walletPayment" style="display: none; margin-top: 20px;">
                    <div class="form-group">
                        <label>موجودی کیف پول:</label>
                        <div style="font-size: 24px; font-weight: 700; color: var(--primary); text-align: center; margin: 10px 0;">
                            <span id="walletBalance">۵۰۰</span> افغانی
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="modal-actions">
                <button class="btn btn-outline" id="cancelPayment">
                    <i class="fas fa-times"></i>
                    انصراف
                </button>
                <button class="btn btn-primary" id="confirmPayment">
                    <i class="fas fa-check"></i>
                    پرداخت
                </button>
            </div>
        </div>
    </div>

    <!-- مدال ورود/ثبتنام -->
    <div class="modal" id="authModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title"><i class="fas fa-user"></i> ورود / ثبتنام</h2>
                <button class="close-modal" id="closeAuthModal">&times;</button>
            </div>
            
            <div class="form-tabs">
                <div class="form-tab active" data-tab="login">ورود</div>
                <div class="form-tab" data-tab="register">ثبتنام</div>
            </div>
            
            <div class="form-tab-content active" id="login-tab">
                <form class="auth-form" id="loginForm">
                    <div class="form-group">
                        <label for="loginEmail">ایمیل یا شماره تماس</label>
                        <div class="input-with-icon">
                            <i class="fas fa-envelope input-icon"></i>
                            <input type="text" id="loginEmail" class="form-input" placeholder="ایمیل یا شماره تماس خود را وارد کنید" required>
                        </div>
                        <div class="error-message" id="loginEmailError"></div>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">رمز عبور</label>
                        <div class="input-with-icon">
                            <i class="fas fa-lock input-icon"></i>
                            <input type="password" id="loginPassword" class="form-input" placeholder="رمز عبور خود را وارد کنید" required>
                            <button type="button" class="password-toggle" id="loginPasswordToggle">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <div class="error-message" id="loginPasswordError"></div>
                    </div>
                    <div class="form-footer">
                        <a href="#" id="forgotPassword">رمز عبور خود را فراموش کردهاید؟</a>
                    </div>
                    <button type="submit" class="btn btn-primary" id="loginSubmitBtn">
                        <i class="fas fa-sign-in-alt"></i>
                        ورود
                    </button>
                </form>
            </div>
            
            <div class="form-tab-content" id="register-tab">
                <form class="auth-form" id="registerForm">
                    <div class="form-group">
                        <label for="registerName">نام کامل</label>
                        <div class="input-with-icon">
                            <i class="fas fa-user input-icon"></i>
                            <input type="text" id="registerName" class="form-input" placeholder="نام کامل خود را وارد کنید" required>
                        </div>
                        <div class="error-message" id="registerNameError"></div>
                    </div>
                    <div class="form-group">
                        <label for="registerEmail">ایمیل</label>
                        <div class="input-with-icon">
                            <i class="fas fa-envelope input-icon"></i>
                            <input type="email" id="registerEmail" class="form-input" placeholder="ایمیل خود را وارد کنید" required>
                        </div>
                        <div class="error-message" id="registerEmailError"></div>
                    </div>
                    <div class="form-group">
                        <label for="registerPhone">شماره تماس</label>
                        <div class="input-with-icon">
                            <i class="fas fa-phone input-icon"></i>
                            <input type="tel" id="registerPhone" class="form-input" placeholder="شماره تماس خود را وارد کنید" required>
                        </div>
                        <div class="error-message" id="registerPhoneError"></div>
                    </div>
                    <div class="form-group">
                        <label for="registerPassword">رمز عبور</label>
                        <div class="input-with-icon">
                            <i class="fas fa-lock input-icon"></i>
                            <input type="password" id="registerPassword" class="form-input" placeholder="رمز عبور خود را وارد کنید" required>
                            <button type="button" class="password-toggle" id="registerPasswordToggle">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <div class="error-message" id="registerPasswordError"></div>
                    </div>
                    <div class="form-group">
                        <label for="registerConfirmPassword">تکرار رمز عبور</label>
                        <div class="input-with-icon">
                            <i class="fas fa-lock input-icon"></i>
                            <input type="password" id="registerConfirmPassword" class="form-input" placeholder="رمز عبور خود را مجدداً وارد کنید" required>
                            <button type="button" class="password-toggle" id="registerConfirmPasswordToggle">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <div class="error-message" id="registerConfirmPasswordError"></div>
                    </div>
                    <div class="form-group">
                        <label for="userType">نوع کاربر</label>
                        <select id="userType" class="form-input" required style="padding: 15px 20px;">
                            <option value="">انتخاب کنید</option>
                            <option value="passenger">مسافر</option>
                            <option value="driver">راننده</option>
                        </select>
                        <div class="error-message" id="userTypeError"></div>
                    </div>
                    <div class="form-footer">
                        با ثبتنام، <a href="#">قوانین و مقررات</a> اسنپ افغانستان را میپذیرید.
                    </div>
                    <button type="submit" class="btn btn-primary" id="registerSubmitBtn">
                        <i class="fas fa-user-plus"></i>
                        ثبتنام
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- نوتیفیکیشن -->
    <div class="notification" id="notification"></div>

    <!-- فوتر -->
    <footer style="display: none;" id="main-footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>اسنپ افغانستان</h3>
                    <ul class="footer-links">
                        <li><a href="#"><i class="fas fa-info-circle"></i> درباره ما</a></li>
                        <li><a href="#"><i class="fas fa-briefcase"></i> فرصتهای کاری</a></li>
                        <li><a href="#"><i class="fas fa-phone"></i> تماس با ما</a></li>
                        <li><a href="#"><i class="fas fa-blog"></i> وبلاگ</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>خدمات</h3>
                    <ul class="footer-links">
                        <li><a href="#"><i class="fas fa-taxi"></i> تاکسی</a></li>
                        <li><a href="https://romal-bargar.vercel.app/"><i class="fas fa-shipping-fast"></i> پیک</a></li>
                        <li><a href="#"><i class="fas fa-motorcycle"></i> موتور</a></li>
                        <li><a href="https://sss111-7s6o.vercel.app/"><i class="fas fa-shopping-cart"></i> بازار</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>مسافران</h3>
                    <ul class="footer-links">
                        <li><a href="#"><i class="fas fa-mobile-alt"></i> دانلود اپلیکیشن</a></li>
                        <li><a href="#"><i class="fas fa-gavel"></i> قوانین و مقررات</a></li>
                        <li><a href="https://chat.whatsapp.com/KEDxklRJDmEESU2b7lVjhr?mode=hqrt3"><i class="fas fa-question-circle"></i> سوالات متداول</a></li>
                        <li><a href="#"><i class="fas fa-shield-alt"></i> حریم خصوصی</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>ارتباط با ما</h3>
                    <p><i class="fas fa-headset"></i> پشتیبانی ۲۴ ساعته</p>
                    <p><i class="fas fa-phone"></i> شماره: ۰۷۰۰۱۲۳۴۵۶</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-whatsapp"></i></a>
                        <a href="#"><i class="fab fa-telegram"></i></a>
                        <a href="#"><i class="fab fa-facebook"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>© ۱۴۰۳ اسنپ افغانستان. تمامی حقوق محفوظ است.</p>
            </div>
        </div>
    </footer>

    <script src="config.js"></script>
    <script src="app.js"></script>
</body>
</html>